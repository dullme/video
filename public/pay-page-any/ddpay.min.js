!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){!function(window){var theUA=window.navigator.userAgent.toLowerCase();if(theUA.match(/msie\s\d+/)&&theUA.match(/msie\s\d+/)[0]||theUA.match(/trident\s?\d+/)&&theUA.match(/trident\s?\d+/)[0]){if((theUA.match(/msie\s\d+/)[0].match(/\d+/)[0]||theUA.match(/trident\s?\d+/)[0])<=9){window.document.writeln("<pre style='text-align:center;color:#fff;background-color:#0cc; height:100%;border:0;position:fixed;top:0;left:0;width:100%;z-index:1234'><h2 style='padding-top:200px;margin:0'><strong>你的浏览器版本太low了,已经和时代脱轨了！推荐使用360浏览器！<br/></strong></h2><h2>点击下载:<a href='https://browser.360.cn/se' target='_blank' style='color:blue;'>360浏览器</a></h2><h2 style='margin:0'></h2></pre>"),window.document.execCommand("Stop")}}}(window),require("./main.js"),require("./util.js"),require("./http.js"),require("./view.js")},{"./http.js":2,"./main.js":3,"./util.js":4,"./view.js":5}],2:[function(require,module,exports){var DDPayHttp=DDPayHttp||{};window.DDPayHttp=DDPayHttp,DDPayHttp.post=function(url,args,cb){var xhr;try{xhr=new XMLHttpRequest}catch(e){try{xhr=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{xhr=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return void alert("您的浏览器不支持AJAX！")}}}xhr.open("POST",url),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.onreadystatechange=function(){if(4==xhr.readyState&&xhr.status>=200&&xhr.status<=207){var response=(xhr.statusText,xhr.responseText);cb&&cb(response)}},xhr.onerror=function(){},xhr.ontimeout=function(){},xhr.send(args)},DDPayHttp.sendPost=function(sendUrl,sendData,cb){DDPayHttp.post(sendUrl,sendData,function(response){console.log("response = "+response);var info={code:500};if(!response)return void(cb&&cb(!1,info));try{info=JSON.parse(response)}catch(e){info={code:500}}switch(info.code){case 200:cb&&cb(!0,info);break;default:cb&&cb(!1,info)}})},DDPayHttp.createOrder=function(params,cb){var playerId=params.playerId||"",appId=params.appId||"",goodsId=params.goodsId||"",goodsPrice=(params.goodsName,params.goodsPrice||"0"),payTo=params.payTo||"";if(!playerId)return void alert("支付用户信息有误！");if(!appId)return void alert("商户appId有误！");if(!payTo)return void alert("选择支付方式有误！");var sendUrl="",sendData="";if("default"==payTo||"AliPay"==payTo){if(!goodsId)return void alert("商品ID有误！");sendUrl=DDPay.postURL+"/myPay/appid_create_order",sendData="payTo="+payTo+"&playerId="+playerId+"&goodsId="+goodsId+"&appId="+appId}else sendUrl=DDPay.postURL+"/myPay/pay_api",sendData="payTo="+payTo+"&playerId="+playerId+"&money="+goodsPrice+"&appId="+appId;console.log("sendUrl: "+sendUrl+"; sendData: "+sendData),DDPayHttp.sendPost(sendUrl,sendData,function(bSucc,info){cb&&cb(bSucc,info)})},DDPayHttp.setCurOrderInfo=function(orderInfo){this.curOrderInfo=orderInfo},DDPayHttp.getCurOrderInfo=function(){return this.curOrderInfo},DDPayHttp.checkPaySucc=function(params,cb){var appId=(params.playerId,params.appId||""),sysTag=params.sysTag||"0";if(!appId)return void console.log("商户appId有误！appId = "+appId);var curOrderInfo=DDPayHttp.getCurOrderInfo();if(!curOrderInfo)return void console.log("订单信息有误！");var orderId=curOrderInfo.orderId;if(!orderId)return void console.log("订单ID有误！orderId = "+orderId);var sendUrl=DDPay.postURL+"/myPay/is_pay_succ",sendData="orderId="+orderId+"&appId="+appId+"&sysTag="+sysTag;console.log("sendUrl: "+sendUrl+"; sendData: "+sendData),DDPayHttp.sendPost(sendUrl,sendData,function(bSucc,info){cb&&cb(bSucc,info)})},console.log("------require httpRequest.js")},{}],3:[function(require,module,exports){var DDPay=DDPay||{};window.DDPay=DDPay,DDPay.postURL="http://120.78.142.80",-1!=window.location.hostname.indexOf("/mypaytest/")&&(DDPay.postURL="http://17337389lh.imwork.net:38220"),"127.0.0.1"!=window.location.hostname&&"localhost"!=window.location.hostname||(DDPay.postURL="http://127.0.0.1"),DDPay._debug_tag_=!0,console.log("------require main.js")},{}],4:[function(require,module,exports){var DDPayUtil=DDPayUtil||{};window.DDPayUtil=DDPayUtil,DDPayUtil.getUrlParams=function(){for(var args={},query=window.location.search.substring(1),pairs=query.split("&"),i=0;i<pairs.length;i++){var pos=pairs[i].indexOf("=");if(-1!=pos){var key=pairs[i].substring(0,pos),value=pairs[i].substring(pos+1);args[key]=decodeURIComponent(value)}}return args},DDPayUtil.randomString=function(len){len=len||32;var strChars="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",maxPos=strChars.length,pwd="";for(i=0;i<len;i++)pwd+=strChars.charAt(Math.floor(Math.random()*maxPos));return pwd},DDPayUtil.isMobileBrowser=function(){var sUserAgent=navigator.userAgent.toLowerCase(),bIsIpad="ipad"==sUserAgent.match(/ipad/i),bIsIphoneOs="iphone os"==sUserAgent.match(/iphone os/i),bIsMidp="midp"==sUserAgent.match(/midp/i),bIsUc7="rv:1.2.3.4"==sUserAgent.match(/rv:1.2.3.4/i),bIsUc="ucweb"==sUserAgent.match(/ucweb/i),bIsAndroid="android"==sUserAgent.match(/android/i),bIsCE="windows ce"==sUserAgent.match(/windows ce/i),bIsWM="windows mobile"==sUserAgent.match(/windows mobile/i);return!!(bIsIpad||bIsIphoneOs||bIsMidp||bIsUc7||bIsUc||bIsAndroid||bIsCE||bIsWM)},DDPayUtil.isWxBrowser=function(){return"micromessenger"==window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},DDPayUtil.isQqBrowser=function(){return!!navigator.userAgent.toLowerCase().match(/mqqbrowser|qzone|qqbrowser/i)},DDPayUtil.isAndroid=function(){var u=navigator.userAgent;return u.indexOf("Android")>-1||u.indexOf("Adr")>-1},DDPayUtil.isiOS=function(){return!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)},DDPayUtil.fty=function(f){f<0&&(f=0);var str=""+f;return f<10?str="00"+f:f<100&&(str="0"+f),str=str.slice(0,-2)+"."+str.slice(-2)},DDPayUtil.strf_to_stry=function(f){return f?(f+="",1==f.length&&(f="00"+f),2==f.length&&(f="0"+f),f.slice(0,-2)+"."+f.slice(-2)):"0"},DDPayUtil.dateFormat=function(date,fmt){var o={"M+":date.getMonth()+1,"d+":date.getDate(),"h+":date.getHours(),"m+":date.getMinutes(),"s+":date.getSeconds(),"q+":Math.floor((date.getMonth()+3)/3),S:date.getMilliseconds()};/(y+)/.test(fmt)&&(fmt=fmt.replace(RegExp.$1,(date.getFullYear()+"").substr(4-RegExp.$1.length)));for(var k in o)new RegExp("("+k+")").test(fmt)&&(fmt=fmt.replace(RegExp.$1,1==RegExp.$1.length?o[k]:("00"+o[k]).substr((""+o[k]).length)));return fmt},console.log("------require util.js")},{}],5:[function(require,module,exports){var DDPayView=DDPayView||{};window.DDPayView=DDPayView,DDPayView.init=function(){var params=DDPayUtil.getUrlParams();DDPayView.initView(params)},DDPayView.relativePath="./",DDPayView.setRelativePath=function(path){DDPayView.relativePath=path},DDPayView._initDocument=function(){$("#contentPay").empty();var strHtml="";strHtml+='<div id="IDdivT" class="divT">',strHtml+='  <P class="title_payPrice">商品价格</P>',strHtml+='  <P id="IDgoodsPrice1" class="payPrice">¥??.??</P>',strHtml+='      <P id="IDgoodsTip" class="payTip">请勿修改金额、备注！</P>',strHtml+="</div>",strHtml+='<div id="IDdivInfo" class="divInfo">',strHtml+='    <P class="infoL">商品名称:</P>',strHtml+='    <P id="IDgoodsName" class="infoR_PayTo">????????</P>',strHtml+='    <P class="infoL">商品价格:</P>',strHtml+='    <P id="IDgoodsPrice2" class="infoR">??.??元</P>',strHtml+='    <P class="infoL">支付方式:</P>',strHtml+='    <P id="IDpayTo" class="infoR_PayTo">?????</P>',strHtml+='    <P class="infoL">支付订单:</P>',strHtml+='    <P id="IDorderId" class="infoR">?????</P>',strHtml+="</div>",strHtml+='<div id="IDdivPay" class="divPay">',strHtml+='    <div id="qrcodeCanvas"></div>',strHtml+='    <img id="ImgPayQrcode" class="ImgPayQrcode"></img>  ',strHtml+='    <P id="IDtextPayPrice" class="textPayPrice">支付00.00元</P>',strHtml+='    <P id="IDtextPayTip" class="textPayTip">(长按二维码,点击"识别图中二维码")</P>',strHtml+='    <P id="IDalipayRealName" class="payTip hide">实名验证(???)</P>',strHtml+='    <input id="IDbtnClosePay" type="button" name="" value="返回" onclick="DDPayView.onClickClosePay()" class="btn hide"/>',strHtml+="</div>",strHtml+='<div id="IDdivPaySucc" class="divPaySucc">',strHtml+='    <img class="ImgPaySucc" src="'+DDPayView.relativePath+'ddpay/Img/paySucc.png"></img>',strHtml+='    <P id="IDtextPaySucc" class="textPaySucc">支付成功</P>',strHtml+='    <P id="IDtextPaySuccVal" class="textPaySuccVal">付款金额00.00元</P>',strHtml+="</div>",strHtml+='<div id="IDdivB" class="divB">',strHtml+='    <P class="textTipBRed">确认支付金额后支付</P>',strHtml+='    <P class="textTipB">点击[立即付款]后，请在一分钟内完成支付</P>',strHtml+='    <P class="textTipB">若一分钟内未支付，请重新点击[立即付款]按钮</P>',strHtml+="</div>",$("#contentPay").append(strHtml)},DDPayView.showRootDiv=function(){$("#contentPay").show()},DDPayView.payParams={},DDPayView.initView=function(params,bInsetWebPage){DDPayView.payParams=params||{};var playerId=params.playerId||"",appId=params.appId||"",goodsName=params.goodsName||"商品",goodsPrice=params.goodsPrice||"0",payTo=params.payTo||"",alipayRealName=params.alipayRealName||"";params.goodsId;if(playerId&&appId&&payTo){DDPayView._initDocument(params),$("#IDdivPay").show(),$("#IDdivPaySucc").hide(),bInsetWebPage&&$("#IDbtnClosePay").show();var yuan=DDPayUtil.strf_to_stry(goodsPrice);switch($("#IDgoodsPrice1").text("¥"+yuan),$("#IDgoodsPrice2").text(yuan+"元"),$("#IDgoodsName").text(goodsName),payTo){case"default":case"wx_any":$("#IDpayTo").text("微信");break;case"AliPay":case"alipay_any_qrcode":$("#IDpayTo").text("支付宝");break;case"alipay_any":$("#IDpayTo").text("支付宝(转账)")}if(alipayRealName&&"alipay_any"==payTo){alipayRealName=decodeURI(alipayRealName);var strAlipayRealName="实名验证("+alipayRealName+")";$("#IDalipayRealName").html(strAlipayRealName),$("#IDalipayRealName").show()}DDPayHttp.createOrder(DDPayView.payParams,function(bSucc,info){if(!bSucc){var msg=info.msg||"创建订单失败！";return void DDPayView.openSysTip(msg)}var orderInfo=info.orderInfo,orderId=orderInfo.orderId;$("#IDorderId").text(orderId),DDPayHttp.setCurOrderInfo(orderInfo),DDPayView.openQrcodePay(orderInfo)})}},DDPayView.backUrl=function(bPaySucc){var succOpenUrl=DDPayView.payParams.succOpenUrl||"";if($("#contentPay").hide(),"function"==typeof DDPayView.payParams.cb&&DDPayView.payParams.cb(bPaySucc),succOpenUrl){var bFind=-1!=window.location.href.slice(0,30).indexOf("www.haoxiangyouxi.com"),bFind1=-1!=succOpenUrl.slice(0,30).indexOf("www.haoxiangyouxi.com");(!bFind||bFind&&bFind1)&&(window.location.href=succOpenUrl)}},DDPayView.onClickClosePay=function(payTo){DDPayView.backUrl()},DDPayView.getPayTo=function(){return DDPayView.payParams.payTo},DDPayView.openQrcodePay=function(orderInfo){var qrcodeURL=orderInfo.qrcodeURL,payPrice=orderInfo.payPrice,payTo=orderInfo.payTo;$("#IDdivPay").show();var strY=DDPayUtil.strf_to_stry(payPrice);strY="支付"+strY+"元",$("#IDtextPayPrice").html(strY);var imgLogo="";"default"==payTo||"wx_any"==payTo?(imgLogo=DDPayView.relativePath+"ddpay/Img/wx.png",DDPayUtil.isWxBrowser()?$("#IDtextPayTip").html('长按二维码,点击"识别图中二维码"'):DDPayUtil.isMobileBrowser()?$("#IDtextPayTip").html("保存图片 - 微信扫一扫 - 从相册选取二维码"):$("#IDtextPayTip").html("打开微信,扫码支付")):"AliPay"==payTo||"alipay_any"==payTo||"alipay_any_qrcode"==payTo?(imgLogo=DDPayView.relativePath+"ddpay/Img/alipay.png",$("#IDtextPayTip").html("打开支付宝,扫码支付")):"QQ"==payTo?(imgLogo=DDPayView.relativePath+"ddpay/Img/qq.png",$("#IDtextPayTip").html("打开手机QQ,扫码支付")):"YSF"==payTo&&(imgLogo=DDPayView.relativePath+"ddpay/Img/ysf.png",$("#IDtextPayTip").html("打开云闪付APP,扫码支付")),$("#qrcodeCanvas").empty(),$("#qrcodeCanvas").qrcode({render:"canvas",text:qrcodeURL,width:"200",height:"200",background:"#ffffff",foreground:"#000000",src:imgLogo,cb:function(){$("#qrcodeCanvas").hide();var canvas=$("#qrcodeCanvas").find("canvas").get(0);$("#ImgPayQrcode").attr("src",canvas.toDataURL("image/png"))}}),DDPayView.setTimerCheckPaySucc(),"AliPay"!=payTo&&"alipay_any"!=payTo&&"alipay_any_qrcode"!=payTo||!DDPayUtil.isMobileBrowser()||DDPayUtil.isWxBrowser()||DDPayUtil.isQqBrowser()||(window.location.href=qrcodeURL)},DDPayView.setTimerCheckPaySucc=function(){var curTime=(new Date).getTime(),startTime=curTime+1e3,endTime=curTime+6e4;DDPayView.payCheckPayTimerId=setInterval(function(){var time=(new Date).getTime();if(!(time<startTime))return time>endTime?void clearInterval(DDPayView.payCheckPayTimerId):void DDPayHttp.checkPaySucc(DDPayView.payParams,function(bSucc,info){if(bSucc){var curOrderInfo=DDPayHttp.getCurOrderInfo();DDPayView.onPaySucc(curOrderInfo)}})},2500)},DDPayView.onPaySucc=function(orderInfo){DDPayView.payCheckPayTimerId&&(clearInterval(DDPayView.payCheckPayTimerId),DDPayView.payCheckPayTimerId=null),$("#IDdivPay").hide(),$("#IDdivPaySucc").show();var payPrice=orderInfo.payPrice,strY=DDPayUtil.strf_to_stry(payPrice);strY="付款金额"+strY+"元",$("#IDtextPaySuccVal").html(strY),setTimeout(function(){DDPayView.backUrl(!0)},1300)},DDPayView.openSysTip=function(opts){$("#IDdiv_g_sys_tip").remove(),"string"==typeof opts&&(opts={strTip:opts}),opts=opts||{},DDPayView.openSysTipData={},DDPayView.openSysTipData.strTitle=opts.strTitle||"系统提示",DDPayView.openSysTipData.strTip=opts.strTip||"",DDPayView.openSysTipData.isScroll=opts.isScroll||!1,DDPayView.openSysTipData.strBtnL=opts.strBtnL||"取消",DDPayView.openSysTipData.strBtnR=opts.strBtnR||"确定",DDPayView.openSysTipData.isOneBtn=opts.isOneBtn||!1,DDPayView.openSysTipData.h110Add=opts.h110Add||0,DDPayView.openSysTipData.h=110+DDPayView.openSysTipData.h110Add,DDPayView.openSysTipData.bNoAutoClose=opts.bNoAutoClose||!1,DDPayView.openSysTipData.idRoot=opts.idRoot||"#contentPay",DDPayView.openSysTipData.cbBtnL=function(){console.log("system tip: click L !"),opts.cbBtnL&&opts.cbBtnL(),DDPayView.openSysTipData.bNoAutoClose||$("#IDdiv_g_sys_tip").remove()},DDPayView.openSysTipData.cbBtnR=function(){console.log("system tip: click R !"),opts.cbBtnR&&opts.cbBtnR(),DDPayView.openSysTipData.bNoAutoClose||$("#IDdiv_g_sys_tip").remove()};var strScroll="";DDPayView.openSysTipData.isScroll&&(strScroll="overflow-y:scroll;");var strHtml=(DDPayView.openSysTipData.h110Add,"");strHtml+='<div id="IDdiv_g_sys_tip" style="width:100%;height:100%;position:fixed;top:0px;">',strHtml+='<div style="width:100%;height:100%;position:fixed;top:0px;background-color:#000;background: rgba(0, 0, 0, 0.5);">',strHtml+='<div id="IDdiv_g_sys_tip_bg" style="width:100%;height:100%;position:fixed;top:0px;">',strHtml+='<div style="width:320px;border-radius:10px;box-shadow: 0px 0px 10px #888888;background-color:#fff;margin:150px auto;">',strHtml+='  <p style="font-size:20px;color:#999;padding:8px 25px 8px 25px;margin:0px 0px 0px 0px;text-align:center;">'+DDPayView.openSysTipData.strTitle+"</p>",strHtml+='  <hr style="height:1px;background-color:#e0e0e0;border:none;border-top:1px solid #eee;" />',strHtml+='  <div style="width:320px;height:'+DDPayView.openSysTipData.h+"px;"+strScroll+'">',strHtml+='      <p style="font-size:16px;color:#999;padding:8px 15px 8px 15px;margin:0px 0px 0px 0px;text-align:left;">'+DDPayView.openSysTipData.strTip+"</p>",strHtml+="  </div>",strHtml+='  <div style="height:50px;">',DDPayView.openSysTipData.isOneBtn?strHtml+='  <p onclick="DDPayView.openSysTipData.cbBtnR()" style="cursor:pointer;height:40px;width:40%;margin:0px auto 10px auto;border:1px solid #eee;background:#32cd4e;text-align:center;line-height:40px;color:#fff;border-radius:6px;">'+DDPayView.openSysTipData.strBtnR+"</p>":(strHtml+='  <p onclick="DDPayView.openSysTipData.cbBtnL()" style="cursor:pointer;height:40px;width:40%;margin:0px auto 10px 16px;border:1px solid #eee;background:#d9524e;text-align:center;line-height:40px;color:#fff;border-radius:6px;float:left;">'+DDPayView.openSysTipData.strBtnL+"</p>",strHtml+='  <p onclick="DDPayView.openSysTipData.cbBtnR()" style="cursor:pointer;height:40px;width:40%;margin:0px 16px 10px auto;border:1px solid #eee;background:#32cd4e;text-align:center;line-height:40px;color:#fff;border-radius:6px;float:right;">'+DDPayView.openSysTipData.strBtnR+"</p>"),strHtml+="</div>",strHtml+="</div>",strHtml+="</div>",strHtml+="</div>",strHtml+="</div>",$(DDPayView.openSysTipData.idRoot).append(strHtml);for(var i=0;i<4;i++)$("#IDdiv_g_sys_tip_bg").animate({left:"-8px"},100),$("#IDdiv_g_sys_tip_bg").animate({left:"0px"},100)},DDPayView.init(),console.log("------require view.js")},{}]},{},[1]);